<!DOCTYPE html>
<html lang="en"><head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>JavaScript: indexedDB in Chromium 8.0.552.5 dev!</title>
    <meta name="description" content="Technical Consulting">
    <link rel="stylesheet" href="/bocoup_lume/pagefind/pagefind-ui.css"><link rel="stylesheet" href="/bocoup_lume/styles.css">
    <link rel="alternate" href="/bocoup_lume/feed.xml" type="application/atom+xml" title="Bocoup">
    <link rel="alternate" href="/bocoup_lume/feed.json" type="application/json" title="Bocoup">
  <script type="text/javascript" src="/bocoup_lume/pagefind/pagefind-ui.js"></script><script type="text/javascript">window.addEventListener('DOMContentLoaded', () => { new PagefindUI({"element":"#search","showImages":false,"showEmptyFilters":true,"resetStyles":false,"bundlePath":"/bocoup_lume/pagefind/","baseUrl":"/bocoup_lume/"}); });</script></head>
  <body>
    <nav class="navbar">
      <a href="/bocoup_lume/" class="navbar-home">
        <strong>Bocoup</strong>
      </a>

      <ul class="navbar-links">
      </ul>

      <div class="navbar-search">
        <div id="search"></div>
      </div>
    </nav>

    <main class="body-post">
      <article class="post" data-pagefind-body="">
  <div class="post-header">
    <h1 class="post-title">JavaScript: indexedDB in Chromium 8.0.552.5 dev!</h1>

    <nav class="post-tags">
    
      <a href="/bocoup_lume/tags/performance/" class="tag">performance</a>
    
      <a href="/bocoup_lume/tags/tools and workflow/" class="tag">tools and workflow</a>
    
      <a href="/bocoup_lume/tags/web applications/" class="tag">web applications</a>
    
    </nav>

    <time class="post-date" datetime="2022-11-22 19:17:22">
      November 22nd, 2022
    </time>
  </div>

  <div class="post-body">
    
    <h3>UPDATE!!! This morning (2010-10-22) Chromium dev channel updated to Chromium 8.0.552.11 dev and the indexedDB implementation has been renamed to webkitIndexedDB.</h3>
<p>I must admit – sometimes browser updates are like Christmas. Like today. I updated Chrome and as usual I went through the motions of inspecting the window (DOMWindow) object in the console looking for new goodies. I was definitely not let down. Right there between HashChangeEvent and Image: The IDB* API. Further down I found the key to them all: indexedDB. So far this is what I’ve come up with as a means to test out the implementation. I plan to add more to the gist as time permits.</p>
<p class="snippet caption">webkit-idb.html</p>
<pre><code class="html hljs language-xml"><span class="hljs-meta">&lt;!doctype <span class="hljs-keyword">html</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">html</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>webkitIndexedDB API<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"webkit-idb.js"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"button"</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"button"</span> <span class="hljs-attr">value</span>=<span class="hljs-string">"message"</span> /&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span>
</code></pre>
<p class="snippet caption">webkit-idb.js</p>
<pre><code class="js hljs language-javascript"><span class="hljs-comment">// *UPDATED* Now used webkit prefixed API. see gist for history to access non-prefixed code</span>
(<span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) {


<span class="hljs-keyword">var</span> <span class="hljs-variable language_">global</span> = <span class="hljs-variable language_">this</span>,
    dbOpen, db, index, result;

dbOpen = webkitIndexedDB.<span class="hljs-title function_">open</span>( <span class="hljs-string">"testDB"</span>, <span class="hljs-string">"This is my temporary indexedDB"</span> );

<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>( <span class="hljs-string">"dbOpen"</span>, dbOpen );

<span class="hljs-comment">/*
IDBRequest {
  errorCode: 0
  onerror: null
  onsuccess: null
  readyState: 2
  result: IDBDatabase
  source: IDBFactory
  transaction: null
  webkitErrorMessage: undefined
}
*/</span>

dbOpen.<span class="hljs-title function_">addEventListener</span>( <span class="hljs-string">"success"</span>, <span class="hljs-keyword">function</span>(<span class="hljs-params"> event </span>) {
  <span class="hljs-comment">//  webkitIDBSuccessEvent</span>
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>( <span class="hljs-string">"event"</span>, event );

  <span class="hljs-comment">//  webkitIDBDatabase</span>
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>( <span class="hljs-string">"open: event.target.result"</span>, event.<span class="hljs-property">target</span>.<span class="hljs-property">result</span> );

  <span class="hljs-comment">// Alias webkitIDBDatabase</span>
  <span class="hljs-keyword">var</span> db = event.<span class="hljs-property">target</span>.<span class="hljs-property">result</span>,
      vdb = db.<span class="hljs-title function_">setVersion</span>( <span class="hljs-title function_">btoa</span>(<span class="hljs-string">"ohhai!"</span>) );

  vdb.<span class="hljs-title function_">addEventListener</span>( <span class="hljs-string">"success"</span>, <span class="hljs-keyword">function</span>(<span class="hljs-params"> event </span>) {

    <span class="hljs-keyword">var</span> prop, store;

    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>( <span class="hljs-string">"set version: event.target.result"</span>, event.<span class="hljs-property">target</span>.<span class="hljs-property">result</span> );
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>( <span class="hljs-string">"db.version"</span>, db.<span class="hljs-property">version</span> );

    <span class="hljs-comment">//  objectStores [methods: contains, item]</span>
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>( <span class="hljs-string">"db"</span>, db );

    <span class="hljs-comment">// DOMStringList</span>
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>( <span class="hljs-string">"db.objectStoreNames"</span>, db.<span class="hljs-property">objectStoreNames</span> );

    <span class="hljs-keyword">if</span> ( !db.<span class="hljs-property">objectStoreNames</span>.<span class="hljs-property">length</span> ) {
      store = db.<span class="hljs-title function_">createObjectStore</span>( <span class="hljs-string">"cooler"</span>, {} );
      index = store.<span class="hljs-title function_">createIndex</span>( <span class="hljs-string">"anIndex"</span>, <span class="hljs-string">"foo"</span>, <span class="hljs-literal">true</span> );

      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>( <span class="hljs-string">"store"</span>, store ); <span class="hljs-comment">// null ?</span>
      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>( <span class="hljs-string">"store.indexNames.contains('anIndex')"</span>, store.<span class="hljs-property">indexNames</span>.<span class="hljs-title function_">contains</span>(<span class="hljs-string">"anIndex"</span>) );
    }

    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>( db.<span class="hljs-property">objectStoreNames</span>.<span class="hljs-title function_">item</span>(<span class="hljs-number">0</span>) );
    <span class="hljs-comment">// "cooler"</span>
  }, <span class="hljs-literal">false</span>);
}, <span class="hljs-literal">false</span>);




<span class="hljs-comment">// Constants</span>
<span class="hljs-comment">// Noted as they appeared in 2010</span>


<span class="hljs-comment">// These are no longer defined</span>
<span class="hljs-comment">// console.log(webkitIDBKeyRange.SINGLE, 0);</span>
<span class="hljs-comment">// console.log(webkitIDBKeyRange.LEFT_OPEN, 1);</span>
<span class="hljs-comment">// console.log(webkitIDBKeyRange.RIGHT_OPEN, 2);</span>
<span class="hljs-comment">// console.log(webkitIDBKeyRange.LEFT_BOUND, 4);</span>
<span class="hljs-comment">// console.log(webkitIDBKeyRange.RIGHT_BOUND, 8);</span>


<span class="hljs-comment">// These do not match 2010v2012</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(webkitIDBDatabaseException.<span class="hljs-property">UNKNOWN_ERR</span>, <span class="hljs-number">0</span>);
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(webkitIDBDatabaseException.<span class="hljs-property">NON_TRANSIENT_ERR</span>, <span class="hljs-number">1</span>);
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(webkitIDBDatabaseException.<span class="hljs-property">NOT_FOUND_ERR</span>, <span class="hljs-number">2</span>);
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(webkitIDBDatabaseException.<span class="hljs-property">CONSTRAINT_ERR</span>, <span class="hljs-number">3</span>);
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(webkitIDBDatabaseException.<span class="hljs-property">DATA_ERR</span>, <span class="hljs-number">4</span>);
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(webkitIDBDatabaseException.<span class="hljs-property">NOT_ALLOWED_ERR</span>, <span class="hljs-number">5</span>);
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(webkitIDBDatabaseException.<span class="hljs-property">SERIAL_ERR</span>, <span class="hljs-number">11</span>);
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(webkitIDBDatabaseException.<span class="hljs-property">RECOVERABLE_ERR</span>, <span class="hljs-number">21</span>);
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(webkitIDBDatabaseException.<span class="hljs-property">TRANSIENT_ERR</span>, <span class="hljs-number">31</span>);
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(webkitIDBDatabaseException.<span class="hljs-property">TIMEOUT_ERR</span>, <span class="hljs-number">32</span>);
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(webkitIDBDatabaseException.<span class="hljs-property">DEADLOCK_ERR</span>, <span class="hljs-number">33</span>);

<span class="hljs-comment">// These match 2010v2012</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(webkitIDBRequest.<span class="hljs-property">LOADING</span>, <span class="hljs-number">1</span>);
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(webkitIDBRequest.<span class="hljs-property">DONE</span>, <span class="hljs-number">2</span>);

<span class="hljs-comment">// These match 2010v2012</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(webkitIDBCursor.<span class="hljs-property">NEXT</span>, <span class="hljs-number">0</span>);
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(webkitIDBCursor.<span class="hljs-property">NEXT_NO_DUPLICATE</span>, <span class="hljs-number">1</span>);
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(webkitIDBCursor.<span class="hljs-property">PREV</span>, <span class="hljs-number">2</span>);
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(webkitIDBCursor.<span class="hljs-property">PREV_NO_DUPLICATE</span>, <span class="hljs-number">3</span>);

<span class="hljs-comment">// These do not match 2010v2012</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(webkitIDBTransaction.<span class="hljs-property">READ_WRITE</span>, <span class="hljs-number">0</span>);
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(webkitIDBTransaction.<span class="hljs-property">READ_ONLY</span>, <span class="hljs-number">1</span>);

<span class="hljs-comment">// This is no longer defined</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(webkitIDBTransaction.<span class="hljs-property">SNAPSHOT_READ</span>, <span class="hljs-number">2</span>);

<span class="hljs-comment">// This took the place of the previous constant</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(webkitIDBTransaction.<span class="hljs-property">VERSION_CHANGE</span>, <span class="hljs-number">3</span>);

})();
</code></pre>

  </div>
</article>

<hr>

<nav class="post-navigation">
  <ul>
    <li>
      ← Previous: <a href="/bocoup_lume/posts/welcome-adam-j-sontag/" rel="prev">Welcome Adam J. Sontag</a>
    </li>
    
    <li>
      <strong>Next: <a href="/bocoup_lume/posts/taking-a-peek-at-googles-new-in-page-analytics/" rel="next">Taking a Peek at Google&amp;#8217;s New In-Page Analytics</a> →</strong>
    </li>
    
  </ul>
</nav>
    </main>

    <footer></footer>

    <!-- Current page: /posts/javascript-indexeddb-in-chromium-8-0-552-5-dev/ -->
  

</body></html>