<!DOCTYPE html>
<html lang="en"><head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Popcorn.js 0.2 Facelift</title>
    <meta name="description" content="Technical Consulting">
    <link rel="stylesheet" href="/bocoup_lume/pagefind/pagefind-ui.css"><link rel="stylesheet" href="/bocoup_lume/styles.css">
    <link rel="alternate" href="/bocoup_lume/feed.xml" type="application/atom+xml" title="Bocoup">
    <link rel="alternate" href="/bocoup_lume/feed.json" type="application/json" title="Bocoup">
  <script type="text/javascript" src="/bocoup_lume/pagefind/pagefind-ui.js"></script><script type="text/javascript">window.addEventListener('DOMContentLoaded', () => { new PagefindUI({"element":"#search","showImages":false,"showEmptyFilters":true,"resetStyles":false,"bundlePath":"/bocoup_lume/pagefind/","baseUrl":"/bocoup_lume/"}); });</script></head>
  <body>
    <nav class="navbar">
      <a href="/bocoup_lume/" class="navbar-home">
        <strong>Bocoup</strong>
      </a>

      <ul class="navbar-links">
      </ul>

      <div class="navbar-search">
        <div id="search"></div>
      </div>
    </nav>

    <main class="body-post">
      <article class="post" data-pagefind-body="">
  <div class="post-header">
    <h1 class="post-title">Popcorn.js 0.2 Facelift</h1>

    <nav class="post-tags">
    
      <a href="/bocoup_lume/tags/html5/" class="tag">html5</a>
    
      <a href="/bocoup_lume/tags/video/" class="tag">video</a>
    
    </nav>

    <time class="post-date" datetime="2022-11-22 19:17:22">
      November 22nd, 2022
    </time>
  </div>

  <div class="post-body">
    
    <p>Popcorn.js, the HTML5 <code>&lt;video&gt;</code> framework, is getting a facelift. Rick, Al and I spent last weekend working on Popcorn with <a href="http://annasob.wordpress.com">Anna</a> and <a href="http://scottdowne.wordpress.com/">Scott</a> from the <a href="http://zenit.senecac.on.ca/wiki/index.php/Main_Page">Centre for Development of Open Technology </a> (CDOT) at Seneca College on the forthcoming release of Popcorn JS.</p>
<h3>The History</h3>
<p>Bocoup’s own <a href="http://nickcammarata.com/">Nick Cammaratta</a> attended a <a href="/bocoup_lume/weblog/popcorn-js/">week long code sprint for Popcorn JS 0.1</a> leading up to the 2010 Mozilla summit back in July of 2010.</p>
<p>At CDOT, Anna and Scott have been working under <a href="http://vocamus.net/dave/">David Humphrey</a> and <a href="http://www.etherworks.ca">Brett Gaylor</a> on Mozilla’s <a href="http://drumbeat.org/webmademovies">Web Made Movies</a> project. For the past 5 months Anna and Scott have solved numerous problems dealing with web video. Their popcorn.js 0.1 demo represents enormous thought leadership in HTML5 <code>&lt;video&gt;</code> interaction.</p>
<p>Mozilla recently engaged Bocoup to develop an authoring tool for Popcorn.js to make it even easier for filmmakers to make web movies with Popcorn. The Popcorn team also invited us to recommend a new approach to organizing the popcorn.js code into a framework that includes better code organization and abstraction, a plugin architecture,  and smart syntactic sugar for interacting with the <code>&lt;video&gt;</code> element.</p>
<h3>Bocoup’s Recommendation</h3>
<p>With this in mind we recommended using an enhanced singleton pattern, originally pioneered by the jQuery project. We made this recommendation based on the desire to organize the Popcorn.js 0.1 demos into a more reusable, modular and extensible structure. We also selected method names that will be familiar to developers in the front end community, and generally designed the API in an approachable way.</p>
<p>One of the original goals for popcorn.js 0.1 was to make it easy for filmmakers to use. For this reason XML declaration was selected as the interface for initializing popcorn. Now that Bocoup is developing an authoring tool for filmmakers, we are able to take a step back and produce a more developer friendly JavaScript API.</p>
<p>Imagine being able to write the following code:</p>
<p class="snippet caption">popcorn-api-examples.js</p>
<pre><code class="js hljs language-javascript"><span class="hljs-title class_">Popcorn</span>(<span class="hljs-string">'#video'</span>)
  .<span class="hljs-title function_">subtitle</span>({
    <span class="hljs-attr">start</span>: <span class="hljs-number">10</span>,
    <span class="hljs-attr">end</span>: <span class="hljs-number">30</span>,
    <span class="hljs-attr">text</span>: <span class="hljs-string">'The title of my video'</span>
  })
  .<span class="hljs-title function_">play</span>()

<span class="hljs-title class_">Popcorn</span>(<span class="hljs-string">'#video2'</span>)
  .<span class="hljs-title function_">subtitle</span>({
    <span class="hljs-attr">start</span>: <span class="hljs-number">10</span>,
    <span class="hljs-attr">end</span>: <span class="hljs-number">20</span>,
    <span class="hljs-attr">text</span>: <span class="hljs-string">'The title of my video'</span>
  },
  {
    <span class="hljs-attr">start</span>: <span class="hljs-number">20</span>,
    <span class="hljs-attr">end</span>: <span class="hljs-number">30</span>,
    <span class="hljs-attr">text</span>: <span class="hljs-string">'The producer of my video'</span>
  })
  .<span class="hljs-title function_">play</span>()
</code></pre>
<p>By using a factory pattern, we were able to use the <code>&lt;video&gt;</code> object’s native methods and properties to build a set of getter, setter and controller functions to include in every Popcorn object. By normalizing these, the framework allows developers to write chainable functions executions off the returned Popcorn object:</p>
<p class="snippet caption">popcorn-api-examples-natives.js</p>
<pre><code class="js hljs language-javascript"><span class="hljs-title class_">Popcorn</span>(<span class="hljs-string">'#video'</span>)
  .<span class="hljs-title function_">play</span>()
  .<span class="hljs-title function_">currentTime</span>(<span class="hljs-number">30</span>)
  .<span class="hljs-title function_">pause</span>()
  .<span class="hljs-title function_">listen</span>(<span class="hljs-string">'timeupdate'</span>, <span class="hljs-keyword">function</span>(<span class="hljs-params">event</span>){
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>( <span class="hljs-variable language_">this</span> ) <span class="hljs-comment">// the current popcorn object</span>
    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">currentTime</span>() <span class="hljs-comment">// the currentTime</span>
  })
  .<span class="hljs-title function_">play</span>()
  .<span class="hljs-title function_">currentTime</span>(<span class="hljs-number">20</span>)
</code></pre>
<p>Popcorn also offers a plugin factory with two signatures.  Pattern 1 below lets you manage time updating by your self, where as patterns 2 and 3 offer a structure to manage your video events for you.</p>
<p class="snippet caption">popcorn-plugin-patterns.js</p>
<pre><code class="js hljs language-javascript"><span class="hljs-comment">// Pattern 1</span>
<span class="hljs-comment">// Provide a function that returns an object</span>
(<span class="hljs-keyword">function</span> (<span class="hljs-params">Popcorn</span>) {
  <span class="hljs-title class_">Popcorn</span>.<span class="hljs-title function_">plugin</span>( <span class="hljs-string">"pluginName"</span> , <span class="hljs-keyword">function</span>(<span class="hljs-params"> options </span>) {
    <span class="hljs-comment">// do stuff</span>
    <span class="hljs-comment">// this refers to the popcorn object</span>

    <span class="hljs-comment">// You are required to return an object</span>
    <span class="hljs-comment">// with a start and end property</span>
    <span class="hljs-keyword">return</span> {
      <span class="hljs-attr">start</span>: <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>){...},
      <span class="hljs-attr">end</span>: <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>){...}
    };
  });
})(<span class="hljs-title class_">Popcorn</span>);


<span class="hljs-comment">// Pattern 2</span>
<span class="hljs-comment">// Provide an object</span>
<span class="hljs-comment">// Popcorn will manage the events</span>
(<span class="hljs-keyword">function</span> (<span class="hljs-params">Popcorn</span>) {
  <span class="hljs-title class_">Popcorn</span>.<span class="hljs-title function_">plugin</span>( <span class="hljs-string">"pluginName"</span> , {
    _setup : <span class="hljs-keyword">function</span>(<span class="hljs-params"> options </span>) {
       <span class="hljs-comment">// setup code, fire on initialization</span>
       <span class="hljs-comment">// options refers to the options passed into the plugin on init</span>
       <span class="hljs-comment">// this refers to the popcorn object</span>
    },
    <span class="hljs-attr">start</span>: <span class="hljs-keyword">function</span>(<span class="hljs-params"> event, options </span>){
       <span class="hljs-comment">// fire on options.start</span>
       <span class="hljs-comment">// event refers to the event object</span>
       <span class="hljs-comment">// options refers to the options passed into the plugin on init</span>
       <span class="hljs-comment">// this refers to the popcorn object</span>
    },
    <span class="hljs-attr">end</span>: <span class="hljs-keyword">function</span>(<span class="hljs-params"> event, options </span>){
       <span class="hljs-comment">// fire on options.end</span>
       <span class="hljs-comment">// event refers to the event object</span>
       <span class="hljs-comment">// options refers to the options passed into the plugin on init</span>
       <span class="hljs-comment">// this refers to the popcorn object</span>
    }
  });
})(<span class="hljs-title class_">Popcorn</span>);


<span class="hljs-comment">// Pattern 3</span>
<span class="hljs-comment">// Provide an object with a plugin wide name space</span>
<span class="hljs-comment">// Popcorn will manage the events</span>
(<span class="hljs-keyword">function</span> (<span class="hljs-params">Popcorn</span>) {
  <span class="hljs-title class_">Popcorn</span>.<span class="hljs-title function_">plugin</span>( <span class="hljs-string">"pluginName"</span>, (<span class="hljs-keyword">function</span>(<span class="hljs-params"></span>){

    <span class="hljs-comment">// Define plugin wide variables out here</span>

    <span class="hljs-keyword">return</span> {
      _setup : <span class="hljs-keyword">function</span>(<span class="hljs-params"> options </span>) {
         <span class="hljs-comment">// setup code, fire on initialization</span>
         <span class="hljs-comment">// options refers to the options passed into the plugin on init</span>
         <span class="hljs-comment">// this refers to the popcorn object</span>
      },
      <span class="hljs-attr">start</span>: <span class="hljs-keyword">function</span>(<span class="hljs-params"> event, options </span>){
         <span class="hljs-comment">// fire on options.start</span>
         <span class="hljs-comment">// event refers to the event object</span>
         <span class="hljs-comment">// options refers to the options passed into the plugin on init</span>
         <span class="hljs-comment">// this refers to the popcorn object</span>
      },
      <span class="hljs-attr">end</span>: <span class="hljs-keyword">function</span>(<span class="hljs-params"> event, options </span>){
         <span class="hljs-comment">// fire on options.end</span>
         <span class="hljs-comment">// event refers to the event object</span>
         <span class="hljs-comment">// options refers to the options passed into the plugin on init</span>
         <span class="hljs-comment">// this refers to the popcorn object</span>
      }
  })();
})(<span class="hljs-title class_">Popcorn</span>);
</code></pre>
<p>This plugin architecture allows popcorn.js core to focus on wrapping the <code>&lt;video&gt;</code> element and managing events on a timeline, thereby externalizing plugin related functionality like <em>‘showing a map of a place at a certain time’</em>, or <em>‘displaying a subtitle at a certain time’</em>.</p>
<p>In addition to taking a solid and fully unit tested stab a <a href="https://github.com/annasob/popcorn-js/blob/0.2/popcorn.js">this new architecture</a> in the <a href="https://github.com/annasob/popcorn-js/tree/0.2">0.2 branch</a> of Popcorn JS this weekend, we started converting the original Popcorn JS 0.1 commands into Popcorn JS 0.2 plugins. We also identified milestones for the Popcorn JS project, and fully ticketed what needs to be done to release 0.2 on time.</p>
<p>The plan is to release a fully document and unit tested Popcorn JS 0.2 with plugins that offer full coverage of the Popcorn JS 0.1 demos on December 21st. If your are interested in getting involved, please join us in the <a href="irc://irc.mozilla.org/popcorn">#popcorn</a> channel on irc.mozilla.org. We would love to work with other developers in the community. For updates, follow <a href="http://twitter.com/popcornjs">@PopcornJS</a> on twitter.</p>

  </div>
</article>

<hr>

<nav class="post-navigation">
  <ul>
    <li>
      ← Previous: <a href="/bocoup_lume/posts/think-long-term-focus-short-term/" rel="prev">Think long term, focus short term</a>
    </li>
    
    <li>
      <strong>Next: <a href="/bocoup_lume/posts/javascript-jquery-bug-fixing-guide/" rel="next">JavaScript: jQuery Bug Fixing Guide</a> →</strong>
    </li>
    
  </ul>
</nav>
    </main>

    <footer></footer>

    <!-- Current page: /posts/popcorn-js-facelift/ -->
  

</body></html>